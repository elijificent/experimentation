{% extends "layout.html" %}

{% block title %}Experiment{% endblock %}

{% block content %}
<h1>Experiment Summary</h1>

<table class="experiment-summary">
  <tbody>
    <tr>
      <td>Experiment Name</td>
      <td>{{ summary['experiment'].name }}</td>
    </tr>
    <tr>
      <td>Experiment UUID</td>
      <td>{{ summary['experiment'].experiment_uuid }}</td>
    </tr>
    <tr>
      <td>Start Date</td>
      {% if summary['experiment'].start_date %}
      <td>{{ summary['experiment'].start_date.strftime('%B %d, %Y %H:%M:%S')  }}</td>
      {% else %}
      <td>---</td>
      {% endif %}
      
    </tr>
    <tr>
      <td>End Date</td>
      {% if summary['experiment'].end_date %}
      <td>{{ summary['experiment'].end_date.strftime('%M %D, %Y %HH:%mm')  }}</td>
      {% else %}
      <td>---</td>
      {% endif %}
    </tr>
    <tr>
      <td>Status</td>
      <td>{{ summary['experiment'].experiment_status.value.title() }}</td>
    </tr>
  </tbody>
</table>

<h2>Experiment Variations</h2>
<table class="experiment-summary">
  <thead>
    <tr>
      <th>Name</th>
      <th>Allocation</th>
      {% if summary['total_allocation'] > 0 %}
      <th>Allocation Percentage</th>
      {% endif %}
      <th>Participants</th>
      <th>Description</th>
      <th>UUID</th>
    </tr>
  </thead>
  <tbody>
    {% for variant in summary['variants'] %}
    <tr>
      <td>{{ variant.name }}</td>
      <td>{{ variant.allocation }}</td>
      {% if summary['total_allocation'] > 0 %}
      <td>{{ variant.allocation / summary['total_allocation'] * 100}}%</td>
      {% endif %}
      <td>{{ variant.participants|length }}</td>
      <td>{{ variant.description }}</td>
      <!-- The variant page has not been created/probably will not be, but this is an easy way to abbreviate the variant uuid
      while still maintaining the ability to view the entire thing. -->
      <td><a href="#/variant?variant_uuid={{ variant.variant_uuid }}">...{{ (variant.variant_uuid|string)[-6:] }}</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}